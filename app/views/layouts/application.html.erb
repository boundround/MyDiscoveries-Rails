<!DOCTYPE html>
<html lang="en">
<% if not @placeprograms %>
	<head>
	  <title><%= full_title(yield(:title)) %></title>

	  <%= stylesheet_link_tag( 'application', media: 'all') %>
		<!--%= @set_css ? stylesheet_link_tag(@set_css) : stylesheet_link_tag("br/custom.css") %-->
	  <%= csrf_meta_tags %>

	  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	  <link href='//fonts.googleapis.com/css?family=Signika:300,400,600,700' rel='stylesheet' type='text/css'>
	  <link href='//fonts.googleapis.com/css?family=Handlee' rel='stylesheet' type='text/css'>

	 <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	 <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	 <!--[if lt IE 9]>
	   <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	   <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	 <![endif]-->

		<link rel="apple-touch-icon" sizes="57x57" href="<%= asset_path('favicons/apple-touch-icon-57x57.png')%>"
		<link rel="apple-touch-icon" sizes="60x60" href="<%= asset_path('favicons/apple-touch-icon-60x60.png')%>"
		<link rel="apple-touch-icon" sizes="72x72" href="<%= asset_path('favicons/apple-touch-icon-72x72.png')%>"
		<link rel="apple-touch-icon" sizes="76x76" href="<%= asset_path('favicons/apple-touch-icon-76x76.png')%>"
		<link rel="apple-touch-icon" sizes="114x114" href="<%= asset_path('favicons/apple-touch-icon-114x114.png')%>"
		<link rel="apple-touch-icon" sizes="120x120" href="<%= asset_path('favicons/apple-touch-icon-120x120.png')%>"
		<link rel="apple-touch-icon" sizes="144x144" href="<%= asset_path('favicons/apple-touch-icon-144x144.png')%>"
		<link rel="icon" type="image/png" href="<%= asset_path('favicons/favicon-32x32.png')%>" sizes="32x32">
		<link rel="icon" type="image/png" href="<%= asset_path('favicons/favicon-96x96.png')%>" sizes="96x96">
		<link rel="icon" type="image/png" href="<%= asset_path('favicons/favicon-16x16.png')%>" sizes="16x16">
		<link rel="manifest" href="<%= asset_path('favicons/manifest.json')%>"
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-TileImage" content="<%= asset_path('favicons/mstile-144x144.png')%>"
		<meta name="theme-color" content="#ffffff">

	  <meta name="viewport" content="width=device-width,
	                                     initial-scale=1.0,
	                                     maximum-scale=1.0,
	                                     user-scalable=no">
	  <%= raw open_graph_image %>
	  <%= render "/layouts/ga" %>

    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            /*background-color: black;*/
        }

        #home-map-wrapper,
        #home-map {
            height: 100%;
            width: 100%;
            position: absolute;
        }
        /*.blur {
        opacity: .5; -webkit-filter: blur(5px); -moz-filter: blur(5px); -o-filter: blur(5px); -ms-filter: blur(5px); filter: blur(5px);
      }*/

        #info-box {
            background-color: white;
            border: 1px solid black;
            top: 30px;
            height: 200px;
            padding: 10px;
            position: absolute;
            right: 30px;
        }

        .home-map-wrapper .overlay {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 9;
            display: block;
            top: 0;
            left: 0;
            z-index: 000;
            opacity: 0;
        }

        .home-map-wrapper.enabled .overlay {
            display: none;
        }

        .no-bg {
            background: transparent !important;
        }
    </style>

	</head>

	<body class="<%= @set_body_class ? @set_body_class : 'homepage' %>">
		<%= javascript_include_tag 'mapbox' %>
	  <%= javascript_include_tag 'application' %>
		<script src="//ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	  <script src="//maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>
	  <%= javascript_include_tag 'froogaloop' %>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.jquery.min.js"></script>

    <%= javascript_include_tag 'froogaloop' %>
    <script>
    function searchCallback(content) {
        if (content.query !== $('#search-box').val()) {
          // do not take out-dated answers into account
          return;
        }
        if (content.hits.length === 0) {
          // no results
          $('#hits').empty();
          return;
        }
        // Scan all hits and display them
        var html = '';
        for (var i = 0; i < content.hits.length; ++i) {
          var hit = content.hits[i];
          html += '<div class="hit">';
          html += '<div class="attribute"><span>' + hit["display_name"] + '</span></div>';
          html += '</div>';
        }
        $('#hits').html(html);
      }
      $(document).ready(function() {
        var $inputfield = $('#search-box');
        // Replace the following values by your ApplicationID and ApiKey.
        var client = $.algolia.Client('KXOYK344AM', 'fce29aca7a9b823b9cacdbc1faa225e2');
        // Replace the following value by the name of the index you want to query.
        var index = client.initIndex('place');
        $inputfield.keyup(function() {
          console.log("keyup");

          index.search($inputfield.val(), { hitsPerPage: 6 })
            .done(searchCallback)
            .fail(function(content) { console.log('Error', content); });

        }).focus().closest('form').on('submit', function(e) {
          // on form submit, store the query string in the anchor
          e.preventDefault();
          console.log(content);
          return false;
        });

      });
    </script>

		<div id="place-holder"></div>
	  <%= render "/layouts/page_loader" %>
	  <% flash.each do |type, message| %>
		  <div class="alert <%= bootstrap_class_for(type) %> fade in">
		    <button class="close" data-dismiss="alert">Ã—</button>
		    <%= message %>
		  </div>
		<% end %>
		<div class="alert-wrapper"></div>

		<%= render "/layouts/admin_menu" %>

	  <div class="app-wrap">
	    <%= yield %>
	  </div>
	  <%= render "/layouts/signin_modals" %>

	  <%= render "/layouts/share_modal" %>

	</body>



<% elsif @placeprograms %>

	    <%= yield %>

<% end %>
</html>
