<div class="container">
  <h1>Edit <%= @place.display_name + ' (ID: ' + @place.id.to_s + ')' %></h1>
  <%= simple_form_for @place, html: { role: 'form'} do |f| %>
    <div class="form-group">
      <%= f.input :display_name, input_html: { class: 'form-control' } %>
    </div>
    <div class="form-group">
      <%= f.input :description, as: :bootsy, label: false, input_html: { class: 'form-control area-description-input' } %>
    </div>
    <div class="form-group">
      <%= f.input :website, input_html: { class: 'form-control' } %>
    </div>
    <div class="form-group">
      <%= f.input :booking_url, input_html: { class: 'form-control' } %>
    </div>
    <div class="form-group">
      <%= f.input :display_address, input_html: { class: 'form-control' } %>
    </div>
    <div class="form-group">
      <%= f.input :phone_number, input_html: { class: 'form-control' } %>
    </div>
    Current Map Icon: <%= label_tag @place.map_icon %><br />
    Change Icon (PNG Only)
    <div class="form-group">
      <%= f.file_field :map_icon, input_html: { class: 'form-control' } %>
    </div>
    <div class="form-group">
      <%= f.input :subscription_level, collection: ["Premium", "standard", "basic", "out", "draft"], required: true %>
    </div>
    <p><input id="pac-input" class="controls" type="text"
        placeholder="Enter a location"></p>

    <div class="map-container">
      <div class="map-canvas"></div>
    </div>

    <div class="form-group lat-lng">
      <%= f.input :latitude, :input_html => { class: 'form-control', "data-geo" => "lat" } %>
      <%= f.input :longitude, :input_html => { class: 'form-control', "data-geo" => "lng" } %>
      <%= f.input :address, placeholder: 'Address', :input_html => { class: 'form-control', "data-geo" => "formatted_address" }, label: "Marker Address" %>
    </div>
    <div class="form-group">
      <%= f.input :area_id, label: 'Change Area', collection: Area.all, as: :select, label_method: :display_name, value_method: :id, required: true %>
    </div>
    <div class="field">
      <% Category.all.each do |category| %>
        <%= hidden_field_tag "place[category_ids][]", nil%>
        <%= check_box_tag "place[category_ids][]", category.id, @place.category_ids.include?(category.id), id: dom_id(category), item_wrapper_class: 'inline' %>
        <%= label_tag dom_id(category), category.name %>&nbsp;&nbsp;&nbsp;&nbsp;
      <% end %>
    </div>
  <div id="table-container">
    <h3>Videos</h3>
    <table class="table table-striped" id="place-table">
      <thead>
        <tr>
          <th>Preview</th>
          <th>Vimeo ID</th>
          <th>Priority</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        <%= f.fields_for :videos do |builder| %>
          <tr>
            <td></td>
            <td><%= builder.text_area :vimeo_id %></td>
            <td><%= builder.select :priority, 1..10 %></td>
            <td></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <div class="form-group">
    <%= f.button :submit, 'Update Place' %>
    </div>
  <% end %>
</div>


<script>
  window.onload = function() {
    $('.caption').on("keypress", function(){
        var len = $(this).val().length;
        $(this).closest('.control-group').next('.charCount').text(140 - len);
    });
  }
</script>

<%= javascript_include_tag 'area.js' %>
